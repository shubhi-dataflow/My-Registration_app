<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    

    <title>Assignment</title>

    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
    <link href="vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="vendor/select2/select2.min.css" rel="stylesheet" media="all">
    <!-- <link href="vendor/datepicker/daterangepicker.css" rel="stylesheet" media="all"> -->
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"> -->
    <link href="static/css/main.css" rel="stylesheet" media="all">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="path/to/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div class="page-wrapper bgColor p-t-130 p-b-100 font-poppins">
        <h1 class="head1">Registration form</h1>
        
        <div class="wrapper wrapper--w680">
            <div class="card card-4">
                <div class="card-body">
                    <h2 class="title">Registration Form</h2>
                    <form id="form_id" method="POST" action="{% url 'reg' %}">
                        {% csrf_token %}
                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">first name</label>
                                    <input class="input--style-4" type="text" id="firstname" name="first_name" placeholder="Enter First Name">
                                     <p id="name_err" style="margin-left:4vh;color:#F00;font-size:small;"></p>
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">last name</label>
                                    <input class="input--style-4" type="text" name="last_name" placeholder="Enter Last Name">
                                </div>
                            </div>
                        </div>
                        
                        <div >
                            <div class="col-10">
                                <div class="input-group">
                                    <label class="label">Email</label>
                                    <input class="input--style-4" type="email" id="email" name="email" placeholder="Enter your email address">
                                    <p id="email_err" style="margin-left:4vh; color:#F00;font-size:small; "></p>

                                </div>
                            </div>
                            
                        </div>

                        <div class="row row-space">
                        <div class="col-2">
                            <div class="input-group">
                                <label class="label">Phone Number</label>
                                <input class="input--style-4" type="text" id ="phone" name="phone" placeholder="Enter your Mobile Number">
                                <p id="mob_err" style="margin-left:4vh; color:#F00;font-size:small; "></p>

                            </div>
                        </div>
                        <div class="col-2">
                            <div class="input-group">
                                <label class="label">Date Of Birth</label>
                                <input class="input--style-4" type="date" id="dob" name="dob" placeholder="Enter your date of birth">
                                		  <p id="dob_err" style="margin-left:4vh; color:#F00;font-size:small; "></p>
		  <p id="dob_err1" style="margin-left:4vh; color:#F00;font-size:small; "></p>
                            </div>
                        </div>
                    </div>
                    
                        <div class="p-t-15">
                            <button id="signup" class="btn btn--radius-2 btn--green" type="button">Register</button>
                        </div>
                    </form>
                    <div class="p-t-15">
                    <div class="w3-container">
                        <button onclick="document.getElementById('id01').style.display='block'" class="w3-button w3-black">View All Registered Users </button>
                      
                        <div id="id01" class="w3-modal">
                          <div class="w3-modal-content">
                            <div class="w3-container">
                              <span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-display-topright">&times;</span>
                              
<table id="customers">
    <th>Sr No.</th>
      <th>Name</th>
      <th>Email Address</th>
      <th>Mobile Number</th>
    <th>Date of Birth</th>
    <th>Actions</th>
    <tbody id="data"> </tbody>

  </table>
  
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                </div>
                
                  
          </div>
        </div>
      </div>
            </div>
        </div>
    </div>


      
    

    <!-- <script src="vendor/jquery/jquery.min.js"></script>    
    <script src="vendor/select2/select2.min.js"></script>
     -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js" integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
     <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="js/global.js"></script>

	<script>
		$(document).ready(function () {
			 $.ajax({ // create an AJAX call...
			  type: 'GET',
			  url: 'view',
			  success: function (response) {
			  	 	var cnt=1;
					var result = '';
					// Display the returned data in browser
					var data=response["user_data"]
					console.log(data)
					for (var i = 0; i < data.length; i++) {

					 result = result + '<tr> <td>'+cnt+'</td><td>'+data[i]['firstname']+'</td><td>'+data[i]['email']+'</td><td>'+data[i]['phone']+'</td><td>'+data[i]['dob']+'</td><td><button class="del" ><i class="fa fa-trash" onclick="Delete_me('+data[i]['id']+')"></i></button></td></tr>';
					 cnt = cnt+1;
					}
					$('#data').html(result);
			  }
			  });

		});
	</script>

<script>
$('#signup').on('click',function(){

		var name=$('#firstname').val();
		var email=$('#email').val();
		var mobile=$('#phone').val();
		var date=$('#dob').val();
		var mob_n=mobile.length;

		let err_c=0;




		if(name==''){
		$('#name_err').text('Name Field is Mandatory');
		err_c+=1;


		}
		else{
		$('#name_err').text('');
		err_c==0;

		}
		if(email==''){
		$('#email_err').text('Email Field is Mandatory');
		err_c+=1;


		}
		else{
		if (/^[a-zA-Z0-9.!#$%&'+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)$/.test(email) === false)
        {
          swal("Please enter a valid email! <html><br></html>For e.g. abc@zmail.com");

        }
		$('#email_err').text('');
		err_c==0;

		}

		if(phone==''){
		$('#mob_err').text('Phone Number is Mandatory');
		err_c+=1;
		}
		else{

		if(mob_n<10 || mob_n>10){
		swal("Phone number should be of 10 digits!!")
		err_c+=1;}
		else{
		$('#mob_err').text('');
		err_c==0;}
				}
		if(date==''){
		$('#dob_err').text('Dob is Mandatory');
		err_c+=1;
		}
		else{
		$('#dob_err').text('');
		err_c==0;
		}
		var dob = new Date(date);
    var month_diff = Date.now() - dob.getTime();
    var age_dt = new Date(month_diff);
    var year = age_dt.getUTCFullYear();
    var age = Math.abs(year - 1970);
    if(age <  18){
    $('#dob_err1').text('You are under 18!!!');
		err_c+=1;
		          }
		else{
		$('#dob_err1').text('');
		err_c==0;
		}
		if(err_c==0){
	$.ajax({ // create an AJAX call...
        data: $('#form_id').serialize(), // get the form data
        type: $('#form_id').attr('method'), // GET or POST
        url: $('#form_id').attr('action'), // the file to call
        success: function (response) { // on success..
             console.log(response);
           if(response.status==1){
			swal({title: "Success", text: "User Added Successfully", type:
            "success"}).then(function(){
             window.location.reload();
   }
);
           }else{
           		swal("Something went Wrong!!!!")
           }
           }
        });
        }
    });

</script>

<script>
    function Delete_me(id){
	URl=$.get("/delete?id="+id,function(response) {
		if(response.status==1){

			swal({title: "Success", text: "Data Deleted Successfully", type:
"success"}).then(function(){
   window.location.reload();
   }
);
           }else{
           		swal("Something went Wrong!...")
           }
	});
}
</script>

</body>
</html>
